<!DOCTYPE html>
<html>
<head>
  <title>IDE AUTOCOMPLETE</title>
  <link rel="stylesheet" type="text/css" href="./index.css">
  <script type="text/javascript" src="./ace.min.js"></script>
  <script type="text/javascript" src="./theme-tomorrow_night_eighties.js"></script>
  <script type="text/javascript" src="./mode-javascript.js"></script>
  <script type="text/javascript" src="./worker-javascript.js"></script>
  <script src="./ext-error_marker.js"></script>
  <script src="./ext-beautify.js"></script>
  <script src="./ext-language_tools.js"></script>
  <script src="./ext-spellcheck.js"></script>
  <script src="./ext-prompt.js"></script>
</head>
<body>
  <div id="placeholder">
    <h1 align="center">
      <img src="./assets/images/logo_transparent.svg" alt=""/><br>
      에디터 로드중...
    </h1>
    <!--
    <img id="placeholder-logo" src="./assets/images/ic_logo_transparent.png" alt="">
    <div id="placeholder-text">
      에디터 로딩중...
    </div>
    -->
  </div>
  <div id="editor" onChange="onChange()"></div>
  <script>
    ace.require("ace/ext/prompt");
    ace.require("ace/ext/spellcheck");
    ace.require("ace/ext/error_marker");
    ace.require("ace/ext/language_tools");
    //const beautify = ace.require("ace/ext/beautify");
    const editor = ace.edit("editor");
    editor.setTheme("ace/theme/tomorrow_night_eighties");
    editor.getSession().setMode("ace/mode/javascript");
    editor.setShowPrintMargin(false);
    editor.setOptions({
        enableBasicAutocompletion: true,
        enableSnippets: false,
        enableLiveAutocompletion: true,
        fontSize: "16px"
    });
    editor.getSession().on("change", () => {
      onChange();
    })

    const onChange = () => {
      const code = editor.getSession().getValue();
      WebviewCallback.onContentChanged(code);
    }

    const setCode = (code) => {
      const prcCode = atob(code);
      //console.log("atob= "+prcCode);
      editor.setValue(decodeURIComponent(prcCode), -1);
      editor.clearSelection();
      //beautify.beautify(editor.getSession());
    }

    WebviewCallback.onLoadComplete();
    const placeHolder = document.getElementById("placeholder");
    if (placeHolder.style.display !== "none") {
      placeHolder.style.display = "none"
    }
  </script>
</body>
</html>